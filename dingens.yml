prefixes:
  brick: https://brickschema.org/schema/Brick#
  csvw: http://www.w3.org/ns/csvw#
  dc: http://purl.org/dc/elements/1.1/
  dcat: http://www.w3.org/ns/dcat#
  dcmitype: http://purl.org/dc/dcmitype/
  dcam: http://purl.org/dc/dcam/
  doap: http://usefulinc.com/ns/doap#
  foaf: http://xmlns.com/foaf/0.1/
  geo: http://www.opengis.net/ont/geosparql#
  odrl: http://www.w3.org/ns/odrl/2/
  org: http://www.w3.org/ns/org#
  prof: http://www.w3.org/ns/dx/prof/
  prov: http://www.w3.org/ns/prov#
  qb: http://purl.org/linked-data/cube#
  schema: https://schema.org/
  sh: http://www.w3.org/ns/shacl#
  skos: http://www.w3.org/2004/02/skos/core#
  sosa: http://www.w3.org/ns/sosa/
  ssn: http://www.w3.org/ns/ssn/
  time: http://www.w3.org/2006/time#
  vann: http://purl.org/vocab/vann/
  void: http://rdfs.org/ns/void#
  wgs: https://www.w3.org/2003/01/geo/wgs84_pos#
  owl: http://www.w3.org/2002/07/owl#
  rdf: http://www.w3.org/1999/02/22-rdf-syntax-ns#
  rdfs: http://www.w3.org/2000/01/rdf-schema#
  xsd: http://www.w3.org/2001/XMLSchema#
  xml: http://www.w3.org/XML/1998/namespace
  rr: http://www.w3.org/ns/r2rml#
  rml: http://semweb.mmlab.be/ns/rml#
  ql: http://semweb.mmlab.be/ns/ql#
  locn: http://www.w3.org/ns/locn#
  dct: http://purl.org/dc/terms/
  tedm: http://data.europa.eu/a4g/mapping/sf-rml/
  epo: http://data.europa.eu/a4g/ontology#
  epd: http://data.europa.eu/a4g/resource/
  cccev: http://data.europa.eu/m8g/
  cc: http://creativecommons.org/ns#
mappings:
  Notice:
    sources:
    - ['%1$s~xpath', /%2$s]
    s: http://data.europa.eu/a4g/resource/id_$(replace(OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_Notice
    po:
    - [rdf:type, epo:Notice]
    - [dct:publisher, $(%3$s)]
    - [rdf:type, $(if(exists(AWARD_CONTRACT) or exists(RESULTS)) then 'http://data.europa.eu/a4g/ontology#ResultNotice' else if(exists(PROCEDURE/DATETIME_RECEIPT_TENDERS) or exists(CONTRACTING_BODY/URL_PARTICIPATION)) then 'http://data.europa.eu/a4g/ontology#CompetitionNotice' else if(@TIME_LIMITS='PRI_REDUCING_TIME_LIMITS') then 'http://data.europa.eu/a4g/ontology#PlanningNotice' else if(exists(MODIFICATIONS_CONTRACT)) then 'http://data.europa.eu/a4g/ontology#ContractModificationNotice' else null )]
    - [epo:hasPublicationDate, $(ADDITIONAL_CORE_DATA/DATE_FIRST_PUBLICATION), xsd:date]
    - [epo:hasDispatchDate, $(COMPLEMENTARY_INFO/DATE_DISPATCH_NOTICE), xsd:date]
    - p: epo:announcesRole
      o:
        mapping: Buyer
        condition:
          function: equal
          parameters:
          - [str1, $(if(name()='KD_7_2_Z2' or name()='KD_8_2_Z3') then 'false' else 'true')]
          - [str2, $('true')]
    - p: epo:announcesRole
      o:
        mapping: AdditionalBuyer
        condition:
          function: equal
          parameters:
          - [str1, $(if(name()='KD_7_2_Z2' or name()='KD_8_2_Z3') then 'false' else 'true')]
          - [str2, $('true')]
    - p: epo:announcesRole
      o:
        mapping: Winner
        condition:
          function: equal
          parameters:
          - [str1, $(if(name()='KD_7_2_Z2' or name()='KD_8_2_Z3') then 'false' else 'true')]
          - [str2, $('true')]
    - p: epo:refersToProcedure
      o:
        mapping: Procedure
    - p: epo:refersToLot
      o:
        mapping: Lot
        condition:
          function: equal
          parameters:
          - [str1, $(if(name()='KD_7_2_Z2' or name()='KD_8_2_Z3') then 'false' else 'true')]
          - [str2, $('true')]
    - p: epo:announcesContract
      o:
        mapping: Contract
        condition:
          function: equal
          parameters:
          - [str1, $(if(name()='KD_7_2_Z2' or name()='KD_8_2_Z3') then 'false' else 'true')]
          - [str2, $('true')]
    - p: epo:refersToContractToBeModified
      o:
        mapping: Contract
        condition:
          function: equal
          parameters:
          - [str1, $(if(name()='KD_7_2_Z2' or name()='KD_8_2_Z3') then 'true' else 'false')]
          - [str2, $('true')]
    - p: epo:announcesNoticeAwardInformation
      o:
        mapping: NoticeAwardInformation
  Procedure:
    sources:
    - ['%1$s~xpath', /%2$s/OBJECT_CONTRACT]
    s: http://data.europa.eu/a4g/resource/id_$(replace(REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_Procedure_$(generate-id(REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:Procedure]
    - p: epo:isSubjectToProcedureSpecificTerm
      o:
        mapping: DirectAwardTerm
    - [epo:hasTitle, $(TITLE/P)]
    - [epo:hasDescription, $(SHORT_DESCR/P)]
    - [epo:hasDescription, $(if(name(..)='KD_8_1_Z3' or name(..)='KD_8_2_Z2') then OBJECT_DESCR/SHORT_DESCR/P else null)]
    - [epo:hasAdditionalInformation, $(../ADDITIONAL_CORE_DATA/PROCEDURE_SHORT_DESCRIPTION/P)]
    - p: epo:hasProcurementScopeDividedIntoLot
      o:
        mapping: Lot
    - p: epo:hasPurpose
      o:
        mapping: ProcedurePurpose
    - p: epo:hasID
      o:
        mapping: ProcedureIdentifier
    - p: epo:foreseesContractSpecificTerm
      o:
        mapping: ContractTermProcedure
    - [epo:hasProcedureType, "http://publications.europa.eu/resource/authority/procurement-procedure-type/{if(exists(../PROCEDURE/PT_OPEN)) then 'open' else if(exists(../PROCEDURE/PT_RESTRICTED)) then 'restricted' else if(exists(../PROCEDURE/PT_COMPETITIVE_NEGOTIATION)) then 'neg-w-call' else if(exists(../PROCEDURE/PT_COMPETITIVE_DIALOGUE)) then 'comp-dial' else if(exists(../PROCEDURE/PT_INNOVATION_PARTNERSHIP)) then 'innovation' else null}"]
    - p: epo:usesTechnique
      o:
        mapping: DynamicPurchaseSystemTechniqueUsage
    - p: epo:usesTechnique
      o:
        mapping: FrameworkAgreementTechniqueUsage
    - p: epo:isSubjectToProcedureSpecificTerm
      o:
        mapping: AccessTerm
    - p: epo:isSubjectToProcedureSpecificTerm
      o:
        mapping: SubmissionTerm
    - p: epo:isSubjectToProcedureSpecificTerm
      o:
        mapping: FrameworkAgreementTermProcedure
  ProcedureIdentifier:
    sources:
    - ['%1$s~xpath', /%2$s/OBJECT_CONTRACT/REFERENCE_NUMBER]
    s: http://data.europa.eu/a4g/resource/id_$(replace(., '[^a-zA-Z0-9]', '-'))-$(replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_ProcedureIdentifier_$(generate-id(.))
    po:
    - [rdf:type, epo:Identifier]
    - [epo:hasIdentifierValue, $(.)]
  AccessTerm:
    sources:
    - ['%1$s~xpath', /%2$s/CONTRACTING_BODY/DOCUMENT_FULL | /%2$s/CONTRACTING_BODY/DOCUMENT_RESTRICTED]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_AccessTerm_$(generate-id(../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:AccessTerm]
    - [epo:isProcurementDocumentRestricted, "$(if(contains(name(), 'RESTRICTED')) then 'true' else 'false')", xsd:boolean]
    - [epo:hasPublicAccessURL, $(../URL_DOCUMENT), xsd:anyURI]
  SubmissionTerm:
    sources:
    - ['%1$s~xpath', /%2$s/PROCEDURE]
    s: $(if(exists(DATETIME_RECEIPT_TENDERS) or exists(../CONTRACTING_BODY/URL_PARTICIPATION)) then 'http://data.europa.eu/a4g/resource/id_' || replace(../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-') || '-' || replace(../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-') || '_SubmissionTerm_' || generate-id(../OBJECT_CONTRACT/REFERENCE_NUMBER) else null)
    po:
    - [rdf:type, epo:SubmissionTerm]
    - [epo:hasReceiptDeadline, $(DATETIME_RECEIPT_TENDERS), xsd:dateTime]
    - [epo:hasReceiptExpressionDeadline, $(if(../@TIME_LIMITS='PRI_REDUCING_TIME_LIMITS' and exists(DATETIME_RECEIPT_TENDERS)) then DATETIME_RECEIPT_TENDERS else null), xsd:dateTime]
    - [epo:hasSubmissionURL, $(../CONTRACTING_BODY/URL_PARTICIPATION), xsd:anyURI]
  ContractTermProcedure:
    sources:
    - ['%1$s~xpath', /%2$s//TYPE_CONTRACT/@CTYPE]
    s: http://data.europa.eu/a4g/resource/id_$(replace(/%2$s/OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(/%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_ContractTermProcedure_$(generate-id(.))
    po:
    - [rdf:type, epo:ContractTerm]
    - [epo:hasContractNatureType, 'http://publications.europa.eu/resource/authority/contract-nature/{lower-case(.)}']
  Lot:
    sources:
    - ['%1$s~xpath', /%2$s/OBJECT_CONTRACT/REFERENCE_NUMBER]
    s: http://data.europa.eu/a4g/resource/id_$(replace(., '[^a-zA-Z0-9]', '-'))-$(replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_Lot_$(generate-id(.))
    po:
    - [rdf:type, epo:Lot]
    - [epo:hasTitle, $(../OBJECT_DESCR/TITLE/P)]
    - [epo:hasDescription, $(if(name(../..)='KD_7_2_Z2' or name(../..)='KD_8_2_Z3') then ../OBJECT_DESCR/SHORT_DESCR/P else null)]
    - p: epo:hasPurpose
      o:
        mapping: LotPurpose
    - p: epo:foreseesContractSpecificTerm
      o:
        mapping: ContractTermLot
        condition:
          function: equal
          parameters:
          - [str1, $(path())]
          - [str2, $(path())]
  ContractTermLot:
    sources:
    - ['%1$s~xpath', /%2$s/OBJECT_CONTRACT/REFERENCE_NUMBER]
    s: $(if(exists(../OBJECT_DESCR/NUTS/@CODE) or exists(../OBJECT_DESCR/MAIN_SITE/P) or exists(../OBJECT_DESCR/DATE_START) or exists(../OBJECT_DESCR/DATE_END) or exists(../OBJECT_DESCR/DURATION)) then 'http://data.europa.eu/a4g/resource/id_' || replace(., '[^a-zA-Z0-9]', '-') || '-' || replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-') || '_ContractTermLot_' || generate-id(.) else null)
    po:
    - [rdf:type, epo:ContractTerm]
    - p: epo:definesSpecificPlaceOfPerformance
      o:
        mapping: ContractTermLotLocation
    - p: epo:definesContractPeriod
      o:
        mapping: Period
    - p: epo:definesContractDuration
      o:
        mapping: Duration
  ContractTermLotLocation:
    sources:
    - ['%1$s~xpath', /%2$s/OBJECT_CONTRACT/OBJECT_DESCR]
    s: $(if(exists(NUTS) or exists(MAIN_SITE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(../REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-') || '-' || replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-')||  '_ContractTermLotLocation_' || generate-id(.) else null)
    po:
    - [rdf:type, dct:Location]
    - [epo:hasNutsCode, 'http://data.europa.eu/nuts/code/{NUTS/@CODE}']
    - p: locn:address
      o:
        mapping: ContractTermLotLocationAddress
  ContractTermLotLocationAddress:
    sources:
    - ['%1$s~xpath', /%2$s/OBJECT_CONTRACT/OBJECT_DESCR]
    s: $(if(exists(MAIN_SITE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(../REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-') || '-' || replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-') || '_ContractTermLotLocationAddress_' || generate-id(.) else null)
    po:
    - [rdf:type, locn:Address]
    - [locn:fullAddress, $(MAIN_SITE/P)]
  ProcedurePurpose:
    sources:
    - ['%1$s~xpath', /%2$s/OBJECT_CONTRACT | /%2$s/MODIFICATIONS_CONTRACT/DESCRIPTION_PROCUREMENT]
    s: $(if(exists(CPV_MAIN/CPV_CODE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(/%2$s/OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-') || '-' || replace(/%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-') || '_ProcedurePurpose_' || generate-id(.) else null)
    po:
    - [rdf:type, epo:Purpose]
    - [epo:hasMainClassification, 'http://data.europa.eu/cpv/cpv/{CPV_MAIN/CPV_CODE/@CODE}']
  LotPurpose:
    sources:
    - ['%1$s~xpath', /%2$s/OBJECT_CONTRACT/OBJECT_DESCR]
    s: $(if(exists(CPV_ADDITIONAL/CPV_CODE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(../REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-') || '-' || replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-') || '_LotPurpose_' || generate-id(.) else null)
    po:
    - [rdf:type, epo:Purpose]
    - [epo:hasAdditionalClassification, 'http://data.europa.eu/cpv/cpv/{CPV_ADDITIONAL/CPV_CODE/@CODE}']
  Buyer:
    sources:
    - ['%1$s~xpath', /%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(NATIONALID, '[^a-zA-Z0-9]', '-'))_Buyer_$(generate-id(NATIONALID))
    po:
    - [rdf:type, epo:Buyer]
    - p: epo:playedBy
      o:
        mapping: Organisation
    - p: epo:hasContactPointInRole
      o:
        mapping: ContactPoint
    - p: epo:contextualisedBy
      o:
        mapping: Procedure
        condition:
          function: equal
          parameters:
          - [str1, $(if(name(../..)='KD_7_2_Z2' or name(../..)='KD_8_2_Z3') then 'true' else 'false')]
          - [str2, $('true')]
  AdditionalBuyer:
    sources:
    - ['%1$s~xpath', /%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY_ADDITIONAL]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_AdditionalBuyer_$(generate-id(NATIONALID))
    po:
    - [rdf:type, epo:Buyer]
    - p: epo:playedBy
      o:
        mapping: AdditionalOrganisation
        condition:
          function: equal
          parameters:
          - [str1, $(NATIONALID)]
          - [str2, $(NATIONALID)]
    - p: epo:hasContactPointInRole
      o:
        mapping: AdditionalContactPoint
        condition:
          function: equal
          parameters:
          - [str1, $(NATIONALID)]
          - [str2, $(NATIONALID)]
    - p: epo:contextualisedBy
      o:
        mapping: Procedure
        condition:
          function: equal
          parameters:
          - [str1, $(if(name()='KD_7_2_Z2' or name()='KD_8_2_Z3') then 'true' else 'false')]
          - [str2, $('true')]
  Organisation:
    sources:
    - ['%1$s~xpath', /%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(NATIONALID, '[^a-zA-Z0-9]', '-'))_Organisation_$(generate-id(NATIONALID))
    po:
    - [rdf:type, org:Organization]
    - [epo:hasLegalName, $(OFFICIALNAME)]
    - p: epo:hasID
      o:
        mapping: OrganisationIdentifier
        condition:
          function: equal
          parameters:
          - [str1, $(NATIONALID)]
          - [str2, $(.)]
    - p: cccev:registeredAddress
      o:
        mapping: OrganisationAddress
  AdditionalOrganisation:
    sources:
    - ['%1$s~xpath', /%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY_ADDITIONAL]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_Organisation_$(generate-id(NATIONALID))
    po:
    - [rdf:type, org:Organization]
    - [epo:hasLegalName, $(OFFICIALNAME)]
    - p: epo:hasID
      o:
        mapping: OrganisationIdentifier
        condition:
          function: equal
          parameters:
          - [str1, $(NATIONALID)]
          - [str2, $(.)]
    - p: cccev:registeredAddress
      o:
        mapping: AdditionalOrganisationAddress
        condition:
          function: equal
          parameters:
          - [str1, $(NATIONALID)]
          - [str2, $(NATIONALID)]
  OrganisationIdentifier:
    sources:
    - ['%1$s~xpath', /%2$s//NATIONALID]
    s: $(if(not(.='')) then 'http://data.europa.eu/a4g/resource/id_' || replace(/%2$s/OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-') || '-' || replace(/%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-') || '_OrganisationIdentifier_' || generate-id(.) else null)
    po:
    - [rdf:type, epo:Identifier]
    - [epo:hasIdentifierValue, $(.)]
  BuyerOrganisationGroup:
    sources:
    - ['%1$s~xpath', '/%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY_ADDITIONAL[1]']
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_BuyerOrganisationGroup_$(generate-id(NATIONALID))
    po:
    - [rdf:type, epo:OrganisationGroup]
    - p: epo:hasMember
      o:
        mapping: Organisation
    - p: epo:hasMember
      o:
        mapping: AdditionalOrganisation
  ContactPoint:
    sources:
    - ['%1$s~xpath', /%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY]
    s: $(if(exists(E_MAIL) or exists(PHONE) or exists(CONTACT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-') || '-' || replace(NATIONALID, '[^a-zA-Z0-9]', '-')||  '_ContactPoint_' || generate-id(.) else null)
    po:
    - [rdf:type, cccev:ContactPoint]
    - [cccev:email, $(E_MAIL)]
    - [cccev:telephone, $(PHONE)]
    - [epo:hasContactName, $(CONTACT)]
  AdditionalContactPoint:
    sources:
    - ['%1$s~xpath', /%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY_ADDITIONAL]
    s: $(if(exists(E_MAIL) or exists(PHONE) or exists(CONTACT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-') || '-' || replace(../ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-')||  '_ContactPoint_' || generate-id(.) else null)
    po:
    - [rdf:type, cccev:ContactPoint]
    - [cccev:email, $(E_MAIL)]
    - [cccev:telephone, $(PHONE)]
    - [epo:hasContactName, $(CONTACT)]
  OrganisationAddress:
    sources:
    - ['%1$s~xpath', /%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(NATIONALID, '[^a-zA-Z0-9]', '-'))_OrganisationAddress_$(generate-id(.))
    po:
    - [rdf:type, locn:Address]
    - [epo:adminUnitL2, $(if(not(exists(DOMAIN))) then null else if(DOMAIN='Vorarlberg') then'http://publications.europa.eu/resource/authority/atu/AUT_BLD_VORALB' else if(DOMAIN='Vienna') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_VIE' else if(DOMAIN='UpperAustria') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_OO' else if(DOMAIN='Tyrol') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_TIROL' else if(DOMAIN='Styria') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_STEIER' else if(DOMAIN='Salzburg') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_SZG' else if(DOMAIN='LowerAustria') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_NO' else if(DOMAIN='Carinthia') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_KAER' else if(DOMAIN='Burgenland') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_BURG' else 'http://publications.europa.eu/resource/authority/atu/AT')]
    - [epo:hasCountryCode, http://publications.europa.eu/resource/authority/country/AUT]
  AdditionalOrganisationAddress:
    sources:
    - ['%1$s~xpath', /%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY_ADDITIONAL]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_OrganisationAddress_$(generate-id(.))
    po:
    - [rdf:type, locn:Address]
    - [epo:adminUnitL2, $(if(not(exists(DOMAIN))) then null else if(DOMAIN='Vorarlberg') then'http://publications.europa.eu/resource/authority/atu/AUT_BLD_VORALB' else if(DOMAIN='Vienna') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_VIE' else if(DOMAIN='UpperAustria') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_OO' else if(DOMAIN='Tyrol') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_TIROL' else if(DOMAIN='Styria') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_STEIER' else if(DOMAIN='Salzburg') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_SZG' else if(DOMAIN='LowerAustria') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_NO' else if(DOMAIN='Carinthia') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_KAER' else if(DOMAIN='Burgenland') then 'http://publications.europa.eu/resource/authority/atu/AUT_BLD_BURG' else 'http://publications.europa.eu/resource/authority/atu/AT')]
    - [epo:hasCountryCode, http://publications.europa.eu/resource/authority/country/AUT]
  Duration:
    sources:
    - ['%1$s~xpath', /%2$s/OBJECT_CONTRACT/OBJECT_DESCR/DURATION]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_Duration_$(generate-id(../../REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:SpecificDuration]
    - [time:numericDuration, $(.), xsd:decimal]
    - [time:unitType, $(if(./@TYPE='MONTH') then 'http://www.w3.org/2006/time#unitMonth' else if(./@TYPE='DAY') then 'http://www.w3.org/2006/time#unitDay' else null )]
  Period:
    sources:
    - ['%1$s~xpath', /%2$s/OBJECT_CONTRACT/OBJECT_DESCR/DATE_START | /%2$s/OBJECT_CONTRACT/OBJECT_DESCR/DATE_END]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_Period_$(generate-id(../../REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:Period]
    - [epo:hasBeginning, $(if(exists(../DATE_START)) then ../DATE_START else null), xsd:date]
    - [epo:hasEnd, $(if(exists(../DATE_END)) then ../DATE_END else null), xsd:date]
  FrameworkAgreementTechniqueUsage:
    sources:
    - ['%1$s~xpath', /%2$s/PROCEDURE/FRAMEWORK]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_FrameworkAgreementTechniqueUsage_$(generate-id(../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:FrameworkAgreementTechniqueUsage]
  FrameworkAgreementTermProcedure:
    sources:
    - ['%1$s~xpath', /%2$s/PROCEDURE/FRAMEWORK]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_FrameworkAgreementTermProcedure_$(generate-id(../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:FrameworkAgreementTerm]
  DynamicPurchaseSystemTechniqueUsage:
    sources:
    - ['%1$s~xpath', /%2$s/PROCEDURE/DPS]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_DynamicPurchaseSystemTechniqueUsage_$(generate-id(../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:DynamicPurchaseSystemTechniqueUsage]
  DirectAwardTerm:
    sources:
    - ['%1$s~xpath', /%2$s/ADDITIONAL_CORE_DATA/D_JUSTIFICATION | /%2$s/PROCEDURE/PT_DIRECT]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_DirectAwardTerm_$(generate-id(../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:DirectAwardTerm]
    - [epo:hasJustification, $(P)]
  Contract:
    sources:
    - ['%1$s~xpath', /%2$s/AWARD_CONTRACT/AWARDED_CONTRACT | /%2$s/RESULTS/AWARDED_PRIZE | /%2$s/ADDITIONAL_CORE_DATA/OBJECT_CONTRACT_MODIFICATIONS]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_Contract_$(generate-id(../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:Contract]
    - [epo:hasContractConclusionDate, $(DATE_CONCLUSION_CONTRACT), xsd:date]
    - [epo:hasTitle, $(TITLE/P)]
    - p: epo:includesLot
      o:
        mapping: Lot
    - p: epo:resultsFromLotAwardOutcome
      o:
        mapping: LotAwardOutcome
  Winner:
    sources:
    - ['%1$s~xpath', /%2$s/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTOR/ADDRESS_CONTRACTOR/OFFICIALNAME | /%2$s/RESULTS/AWARDED_PRIZE/WINNER/ADDRESS_WINNER/OFFICIALNAME | /%2$s/MODIFICATIONS_CONTRACT/DESCRIPTION_PROCUREMENT/CONTRACTOR/ADDRESS_CONTRACTOR/OFFICIALNAME]
    s: http://data.europa.eu/a4g/resource/id_$(replace(/%2$s/OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(/%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_Winner_$(generate-id(.))
    po:
    - [rdf:type, epo:Winner]
    - p: epo:contextualisedBy
      o:
        mapping: Procedure
        condition:
          function: equal
          parameters:
          - [str1, $(if(name(../../../../..)='KD_7_2_Z2' or name(../../../../..)='KD_8_2_Z3') then 'true' else 'false')]
          - [str2, $('true')]
    - p: epo:playedBy
      o:
        mapping: ContractorOrganisation
        condition:
          function: equal
          parameters:
          - [str1, $(.)]
          - [str2, $(.)]
  ContractorOrganisation:
    sources:
    - ['%1$s~xpath', /%2$s/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTOR/ADDRESS_CONTRACTOR/OFFICIALNAME | /%2$s/RESULTS/AWARDED_PRIZE/WINNER/ADDRESS_WINNER/OFFICIALNAME | /%2$s/MODIFICATIONS_CONTRACT/DESCRIPTION_PROCUREMENT/CONTRACTOR/ADDRESS_CONTRACTOR/OFFICIALNAME]
    s: http://data.europa.eu/a4g/resource/id_$(replace(/%2$s/OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(/%2$s/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_Organisation_$(generate-id(.))
    po:
    - [rdf:type, org:Organization]
    - [epo:hasLegalName, $(.)]
    - p: epo:hasID
      o:
        mapping: OrganisationIdentifier
        condition:
          function: equal
          parameters:
          - [str1, $(../NATIONALID)]
          - [str2, $(.)]
  LotAwardOutcome:
    sources:
    - ['%1$s~xpath', /%2$s/AWARD_CONTRACT/AWARDED_CONTRACT/VAL_TOTAL | /%2$s/RESULTS/AWARDED_PRIZE/VAL_PRIZE | /%2$s/MODIFICATIONS_CONTRACT/INFO_MODIFICATIONS/VAL_TOTAL_BEFORE]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_LotAwardOutcome_$(generate-id(../../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:LotAwardOutcome]
    - p: epo:hasAwardedValue
      o:
        mapping: LotAwardOutcomeAwardedMonetaryValue
    - p: epo:describesLot
      o:
        mapping: Lot
  LotAwardOutcomeAwardedMonetaryValue:
    sources:
    - ['%1$s~xpath', /%2$s/AWARD_CONTRACT/AWARDED_CONTRACT/VAL_TOTAL | /%2$s/RESULTS/AWARDED_PRIZE/VAL_PRIZE | /%2$s/MODIFICATIONS_CONTRACT/INFO_MODIFICATIONS/VAL_TOTAL_BEFORE]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_LotAwardOutcomeAwardedMonetaryValue_$(generate-id(../../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:MonetaryValue]
    - [epo:hasAmountValue, $(.), xsd:decimal]
    - [epo:hasCurrency, 'http://publications.europa.eu/resource/authority/currency/{@CURRENCY}']
  SubmissionStatisticalInformation:
    sources:
    - ['%1$s~xpath', /%2$s/AWARD_CONTRACT/AWARDED_CONTRACT | /%2$s/RESULTS/AWARDED_PRIZE | /%2$s/MODIFICATIONS_CONTRACT/INFO_MODIFICATIONS]
    s: $(if(exists(NB_TENDERS_RECEIVED) or exists(NB_SME_TENDER) or exists(NB_PARTICIPANTS) or exists(NB_PARTICIPANTS_SME) or exists(VAL_TOTAL) or exists(VAL_PRIZE) or exists(VAL_TOTAL_BEFORE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-') || '-' || replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-')||  '_SubmissionStatisticalInformation_' || generate-id(../../OBJECT_CONTRACT/REFERENCE_NUMBER) else null)
    po:
    - [rdf:type, epo:SubmissionStatisticalInformation]
    - [epo:hasReceivedTenders, $(NB_TENDERS_RECEIVED), xsd:integer]
    - [epo:hasReceivedSMETenders, $(NB_SME_TENDER), xsd:integer]
    - [epo:hasReceivedTenders, $(NB_PARTICIPANTS), xsd:integer]
    - [epo:hasReceivedSMETenders, $(NB_PARTICIPANTS_SME), xsd:integer]
    - p: epo:summarisesInformationForLotAwardOutcome
      o:
        mapping: LotAwardOutcome
  NoticeChange:
    sources:
    - ['%1$s~xpath', /%2$s/ADDITIONAL_CORE_DATA/DATETIME_LAST_CHANGE]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_NoticeChange_$(generate-id(../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:NoticeChange]
    - p: epo:refersToPrevious
      o:
        mapping: Notice
    - p: epo:hasElementChange
      o:
        mapping: ElementChangeDescription
  ElementChangeDescription:
    sources:
    - ['%1$s~xpath', /%2$s/ADDITIONAL_CORE_DATA/DATETIME_LAST_CHANGE]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_ElementChangeDescription_$(generate-id(../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:ElementChangeDescription]
    - [epo:hasProcurementDocumentChangeDate, $(.), xsd:dateTime]
  ProcedureModification:
    sources:
    - ['%1$s~xpath', /%2$s/MODIFICATIONS_CONTRACT]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_ProcedureModification_$(generate-id(../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:Procedure]
    - p: epo:containsModificationsOf
      o:
        mapping: Procedure
  LotModification:
    sources:
    - ['%1$s~xpath', /%2$s/MODIFICATIONS_CONTRACT]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_LotModification_$(generate-id(../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:Lot]
    - [epo:hasDescription, $(DESCRIPTION_PROCUREMENT/SHORT_DESCR/P)]
    - p: epo:containsModificationsOf
      o:
        mapping: Lot
    - p: epo:hasPurpose
      o:
        mapping: LotPurposeModification
  LotPurposeModification:
    sources:
    - ['%1$s~xpath', /%2$s/MODIFICATIONS_CONTRACT/DESCRIPTION_PROCUREMENT]
    s: $(if(exists(CPV_ADDITIONAL/CPV_CODE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-') || '-' || replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-') || '_LotPurposeModification_' || generate-id(.) else null)
    po:
    - [rdf:type, epo:Purpose]
    - [epo:hasAdditionalClassification, 'http://data.europa.eu/cpv/cpv/{CPV_ADDITIONAL/CPV_CODE/@CODE}']
  LotAwardOutcomeModification:
    sources:
    - ['%1$s~xpath', /%2$s/MODIFICATIONS_CONTRACT/INFO_MODIFICATIONS/VAL_TOTAL_AFTER]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_LotAwardOutcomeModification_$(generate-id(../../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:LotAwardOutcome]
    - p: epo:hasAwardedValue
      o:
        mapping: LotAwardOutcomeAwardedMonetaryValueModification
    - p: epo:describesLot
      o:
        mapping: LotModification
  LotAwardOutcomeAwardedMonetaryValueModification:
    sources:
    - ['%1$s~xpath', /%2$s/MODIFICATIONS_CONTRACT/INFO_MODIFICATIONS/VAL_TOTAL_AFTER]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_LotAwardOutcomeAwardedMonetaryValueModification_$(generate-id(../../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:MonetaryValue]
    - [epo:hasAmountValue, $(.), xsd:decimal]
    - [epo:hasCurrency, 'http://publications.europa.eu/resource/authority/currency/{@CURRENCY}']
  NoticeAwardInformation:
    sources:
    - ['%1$s~xpath', /%2$s/AWARD_CONTRACT/AWARDED_CONTRACT/VAL_TOTAL | /%2$s/RESULTS/AWARDED_PRIZE/VAL_PRIZE | /%2$s/MODIFICATIONS_CONTRACT/INFO_MODIFICATIONS/VAL_TOTAL_AFTER]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_NoticeAwardInformation_$(generate-id(../../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:NoticeAwardInformation]
    - [epo:hasTotalAwardedValue, $(.), xsd:decimal]
  ContractModification:
    sources:
    - ['%1$s~xpath', /%2$s/MODIFICATIONS_CONTRACT/INFO_MODIFICATIONS]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_ContractModification_$(generate-id(../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:ContractModification]
    - p: epo:describesNotice
      o:
        mapping: Notice
    - p: epo:hasElementModification
      o:
        mapping: ElementModificationDescription
  ElementModificationDescription:
    sources:
    - ['%1$s~xpath', /%2$s/MODIFICATIONS_CONTRACT/INFO_MODIFICATIONS/ADDITIONAL_NEED | /%2$s/MODIFICATIONS_CONTRACT/INFO_MODIFICATIONS/UNFORESEEN_CIRCUMSTANCE]
    s: http://data.europa.eu/a4g/resource/id_$(replace(../../../OBJECT_CONTRACT/REFERENCE_NUMBER, '[^a-zA-Z0-9]', '-'))-$(replace(../../../CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/NATIONALID, '[^a-zA-Z0-9]', '-'))_ElementModificationDescription_$(generate-id(../../../OBJECT_CONTRACT/REFERENCE_NUMBER))
    po:
    - [rdf:type, epo:ElementModificationDescription]
    - [epo:hasModificationJustification, $(if(name()='ADDITIONAL_NEED') then 'http://publications.europa.eu/resource/authority/modification-justification/add-wss' else if(name()='UNFORESEEN_CIRCUMSTANCE') then 'http://publications.europa.eu/resource/authority/modification-justification/mod-cir' else null)]
    - [epo:hasModificationReasonDescription, $(P)]
